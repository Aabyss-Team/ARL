(window.webpackJsonp=window.webpackJsonp||[]).push([["assetsMonitor~f71cff67"],{"0487":function(t,e,s){"use strict";s.d(e,"c",(function(){return n})),s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return i})),s.d(e,"f",(function(){return r})),s.d(e,"d",(function(){return c})),s.d(e,"e",(function(){return u})),s.d(e,"g",(function(){return l}));var a=s("e20a"),n=function(t){return a.a.get("/scheduler/",{params:t})},o=function(t){return a.a.post("/scheduler/add/",t)},i=function(t){return a.a.post("/scheduler/delete/",t)},r=function(t){return a.a.post("/scheduler/stop/",t)},c=function(t){return a.a.post("/scheduler/recover/",t)},u=function(t){return a.a.post("/scheduler/recover/batch",t)},l=function(t){return a.a.post("/scheduler/stop/batch",t)}},"151a":function(t,e,s){},2805:function(t,e,s){},7956:function(t,e,s){"use strict";var a=s("151a");s.n(a).a},"979a":function(t,e,s){"use strict";var a=s("ec56");s.n(a).a},d550:function(t,e,s){"use strict";var a={name:"batchDelete",props:{selectedRowKeys:{type:Array,default:function(){return[]}}},methods:{deleteCallback:function(){this.$emit("deleteCallback")}}},n=(s("fb70"),s("2877")),o=Object(n.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"option-btn inline-btn"},[this.selectedRowKeys.length?e("a-popconfirm",{attrs:{"ok-text":"确认","cancel-text":"取消"},on:{confirm:this.deleteCallback}},[e("template",{slot:"title"},[e("p",[this._v("确认删除所选数据吗？")])]),e("a-button",[this._v("批量删除")])],2):e("a-button",{attrs:{disabled:!0}},[this._v("批量删除")]),this._t("default")],2)}),[],!1,null,"4072efce",null);e.a=o.exports},e6c5:function(t,e,s){"use strict";s.r(e),s("4160"),s("caad"),s("b0c0"),s("b64b"),s("d3b7"),s("a79d"),s("2532"),s("159b");var a=s("5530"),n=s("2877"),o=Object(n.a)({},(function(t,e){return(0,e._c)("a",{staticClass:"ftColor",attrs:{href:"/groupAssetsManagement?scope_id="+e.props.text,title:e.props.text}},[e._v(e._s(e.props.text.length>26?e.props.text.slice(0,26)+"...":e.props.text))])}),[],!0,null,null,null).exports,i={props:{text:{type:String},record:{type:Object}},methods:{taskOption:function(t,e){this.$emit("operateCallback",e,t)}}},r=(s("7956"),Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{},[s("a-button",{staticClass:"fr16",attrs:{disabled:"stop"===t.record.status},on:{click:function(e){return t.taskOption(t.record._id,"stop")}}},[t._v("暂停")]),s("a-button",{staticClass:"fr16",attrs:{disabled:"stop"!==t.record.status},on:{click:function(e){return t.taskOption(t.record._id,"recover")}}},[t._v("恢复")]),s("a-popconfirm",{attrs:{"ok-text":"确认","cancel-text":"取消"},on:{confirm:function(e){return t.taskOption(t.record._id,"delete")}}},[s("template",{slot:"title"},[s("p",[t._v("删除后无法恢复，确认删除吗？")])]),s("a-button",{staticClass:"operate-link"},[t._v("删除")])],2)],1)}),[],!1,null,"635075ad",null).exports),c=Object(n.a)({},(function(t,e){return(0,e._c)("span",{staticClass:"ftColor",attrs:{title:e.props.text},on:{click:function(t){e.$router.push({name:"taskList",query:{name:e.props.record.name.length>30?e.props.record.name.slice(0,30):e.props.record.name,target:e.props.record.domain}})}}},[e._v(e._s(e.props.text.length>26?e.props.text.slice(0,26)+"...":e.props.text))])}),[],!0,null,null,null).exports,u=[{title:"序号",dataIndex:"index",width:100},{title:"名称",dataIndex:"name",width:200},{title:"域名",dataIndex:"domain",width:200,sorter:!0,scopedSlots:{customRender:"domain",component:Object(n.a)({},(function(t,e){var s=e._c;return s("a-tooltip",[s("template",{slot:"title"},[s("div",{staticStyle:{height:"200px","overflow-y":"auto"}},[e._v(" "+e._s(e.props.text)+" ")])]),e._v(" "+e._s(e.props.text.length>30?e.props.text.slice(0,30)+"...":e.props.text)+" ")],2)}),[],!0,null,null,null).exports}},{width:280,title:"资产组范围ID",dataIndex:"scope_id",scopedSlots:{customRender:"scope_id",component:o}},{width:100,title:"运行间隔",dataIndex:"interval"},{width:200,title:"上一次运行日期",dataIndex:"last_run_date"},{width:200,title:"下一次运行日期",dataIndex:"next_run_date"},{width:120,title:"运行次数",sorter:!0,dataIndex:"run_number",scopedSlots:{customRender:"run_number",component:c}},{width:280,title:"操作",fixed:"right",dataIndex:"operate",scopedSlots:{customRender:"operate",component:r}}],l=[{name:"名称",key:"name"},{name:"域名",key:"domain"},{name:"资产范围ID",key:"scope_id"}],d=s("d550"),p=s("0487"),h={components:{batchDelete:d.a},data:function(){return{searchList:l,isLoading:!1,total:0,params:{page:1,size:10},selectedRowKeys:[],columns:u,dataList:[]}},mounted:function(){this.checkInitParams(),this.initData()},watch:{$route:function(t,e){this.checkInitParams(),this.initData()}},methods:{searchData:function(t,e){for(var s in this.params.page=1,this.params.size=10,this.$route.query[t]=e,this.$route.query)this.$route.query[s]||delete this.$route.query[s];this.$route.query.page=1,this.$route.query.size=10,this.$router.push({query:Object(a.a)(Object(a.a)({},this.$route.query),{},{ts:(new Date).getTime()})})},changeRowSelect:function(t){this.selectedRowKeys=t},checkInitParams:function(){for(var t in this.params={page:1,size:10},this.$route.query)["page","size"].includes(t)&&(this.$route.query[t]=parseInt(this.$route.query[t])),this.params[t]=this.$route.query[t]},changeCallback:function(t,e,s){var a;a=this.params.order?this.params.order.includes("-")?"":"-"+s.columnKey:s.columnKey,this.params.order=a,this.initData()},initData:function(){var t=this,e={};Object.keys(this.params).forEach((function(s){void 0!==t.params[s]&&t.params[s]&&(e[s]=t.params[s])})),this.isLoading=!0,Object(p.c)(Object(a.a)({},e)).then((function(e){200===e.code?(e.items.forEach((function(e,s){e.key=e._id,e.index=(t.params.page-1)*t.params.size+s+1+"",e.name=e.name?e.name:"-",e.run_number+="",e.interval=Math.round(e.interval/3600)+" 小时",Object.keys(e).forEach((function(t){t||(e[t]="-")}))})),t.dataList=e.items,t.total=e.total,document.querySelector("#contentWrap").scrollTop=0):t.dataList=[]})).finally((function(){t.isLoading=!1}))},optionFunction:function(t,e){switch(t){case"delete":this.deleteTaskOption(e);break;case"stop":this.stopTaskOption(e);break;case"recover":this.recoverTaskOption(e)}},deleteTaskOption:function(t){var e=this;Object(p.b)({job_id:[t]}).then((function(t){200===t.code&&(e.$message.success("删除成功"),e.initData())}))},stopTaskOption:function(t){var e=this;Object(p.f)({job_id:t}).then((function(t){200===t.code&&(e.$message.success("暂停成功"),e.initData())}))},recoverTaskOption:function(t){var e=this;Object(p.d)({job_id:t}).then((function(t){200===t.code&&(e.$message.success("恢复成功"),e.initData())}))},deleteSelectData:function(){var t=this;Object(p.b)({job_id:this.selectedRowKeys}).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.selectedRowKeys=[],t.initData())}))},recoverTasks:function(){var t=this;Object(p.e)({job_id:this.selectedRowKeys}).then((function(e){200===e.code&&(t.$message.success("恢复成功"),t.selectedRowKeys=[],t.initData())}))},stopTasks:function(){var t=this;Object(p.g)({job_id:this.selectedRowKeys}).then((function(e){200===e.code&&(t.$message.success("成功"),t.selectedRowKeys=[],t.initData())}))},changeFunction:function(t,e){this.selectedRowKeys=[],this.params.page=this.params.size===e?t:1,this.params.size=e,this.$route.query.page=this.params.page,this.$route.query.size=this.params.size,this.$router.push({query:Object(a.a)(Object(a.a)({},this.$route.query),{},{ts:(new Date).getTime()})})}}},f=(s("979a"),Object(n.a)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"taskList table-wrap"},[s("div",{staticClass:"search-wrap"},t._l(t.searchList,(function(e){return s("span",{key:e.key,staticClass:"item"},[s("span",{staticClass:"label"},[t._v(t._s(e.name)+": ")]),s("a-input-search",{staticStyle:{width:"260px"},attrs:{allowClear:"",placeholder:"请输入"+e.name+"进行搜索"},on:{search:function(s){return t.searchData(e.key,t.params[e.key])}},model:{value:t.params[e.key],callback:function(s){t.$set(t.params,e.key,s)},expression:"params[item.key]"}})],1)})),0),s("batch-delete",{attrs:{selectedRowKeys:t.selectedRowKeys},on:{deleteCallback:t.deleteSelectData}},[[s("a-button",{attrs:{disabled:0==t.selectedRowKeys.length},on:{click:t.stopTasks}},[t._v("批量停止")]),s("a-button",{attrs:{disabled:0==t.selectedRowKeys.length},on:{click:t.recoverTasks}},[t._v("批量恢复")])]],2),s("table-component",{attrs:{columns:t.columns,isSelect:!0,isLoading:t.isLoading,selectedRowKeys:t.selectedRowKeys,tableList:t.dataList,pagination:!1,scroll:{x:1e3},total:t.total,params:t.params},on:{selectRowCallback:t.changeRowSelect,turnPageCallback:t.changeFunction,operateCallback:t.optionFunction,changeCallback:t.changeCallback}})],1)}),[],!1,null,"5afc1871",null));e.default=f.exports},ec56:function(t,e,s){},fb70:function(t,e,s){"use strict";var a=s("2805");s.n(a).a}}]);